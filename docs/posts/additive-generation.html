<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Achim Krause - Additively generating modular units</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <script>
        MathJax = {
          tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            macros: {
              bN: "\\mathbb{N}",
              bZ: "\\mathbb{Z}",
              bQ: "\\mathbb{Q}",
              bR: "\\mathbb{R}",
              bC: "\\mathbb{C}",
              bS: "\\mathbb{S}"
            }
          },
          svg: {
            fontCache: 'global'
          }
        };
        </script>
        <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
        </script>
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Achim Krause</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
                <a href="../writing.html">Writing</a>
                <a href="../about.html">About Me</a>
                <a href="../blog.html">Blog</a>
            </div>
        </div>

        <div id="content">
            <h1>Additively generating modular units</h1>

            <div class="info">
    Posted on May  4, 2025
    
</div>

<p>This post answers affirmatively a question asked by user Irwin at <a href="https://mathoverflow.net/questions/491704">Mathoverflow</a>.</p>
<p><strong>Definition.</strong> For any positive integer <span class="math inline">\(m\)</span>, let <span class="math inline">\(S_m\subseteq (\bZ/m)^\times\)</span> be the smallest subset which contains <span class="math inline">\(1\)</span> and is closed under addition in the following sense: If <span class="math inline">\(x,y\in S_m\)</span> and <span class="math inline">\(x+y\in (\bZ/m)^\times\)</span>, then also <span class="math inline">\(x+y\in S_m\)</span>.</p>
<p>As was already pointed out in the MO thread, clearly <span class="math inline">\(S_m=\{1\}\)</span> if <span class="math inline">\(m\)</span> is even. Moreover, one explicitly checks <span class="math inline">\(S_{15}=\{1,2,4,8\}\)</span>, so <span class="math inline">\(S_{15}\)</span> is a proper subset of <span class="math inline">\((\bZ/15)^\times\)</span>. The MO question amounts to the following:</p>
<p><strong>Conjecture.</strong> For odd <span class="math inline">\(m\)</span>, <span class="math inline">\(S_m = (\bZ/m)^\times\)</span> if and only if <span class="math inline">\(15\)</span> does not divide <span class="math inline">\(m\)</span>.</p>
<p>The “only if” part is straightforward: If <span class="math inline">\(d\mid m\)</span>, the map <span class="math inline">\((\bZ/m)^\times \to (\bZ/d)^\times\)</span> takes <span class="math inline">\(S_m\)</span> into <span class="math inline">\(S_d\)</span> (for example because the preimage of <span class="math inline">\(S_d\)</span> is also closed under “coprime addition”). So if <span class="math inline">\(S_d \neq (\bZ/d)^\times\)</span>, then also <span class="math inline">\(S_m\neq (\bZ/m)^\times\)</span>.
The evidence discussed for this statement in the MO thread is extremely thin, the OP mentions having checked it for <span class="math inline">\(m&lt;100\)</span>. I hacked together a small python script implementing the most naive algorithm to check for a slightly larger counterexample; this was practical up to <span class="math inline">\(m&lt;1200\)</span> and further confirmed the guess. Now usually numerical evidence is not worth a lot in number theory, even if carried out into the billions, and my expectation was that there would probably some large counterexample made up of many prime factors conspiring in exactly the right way, but that it would be impossible to find. While trying to deduce as many constraints on such a counterexample, I was very surprised to find the following:</p>
<p><strong>Theorem.</strong> The conjecture is true!</p>
<p>We will prove this below. Our strategy will be to first deduce a couple of basic results about small numbers in <span class="math inline">\(S_m\)</span>, and then produce some powerful multiplicative properties of <span class="math inline">\(S_m\)</span>. Among those will be one that allows us to decompose any hypothetical counterexample into smaller ones, leading to a contradiction.</p>
<p><strong>Lemma 1.</strong> If <span class="math inline">\(p_1 &lt; p_2 &lt; \ldots\)</span> denotes the prime factors of <span class="math inline">\(m\)</span> (odd and not divisible by <span class="math inline">\(15\)</span>) ordered by size, then <span class="math inline">\(S_m\)</span> contains all numbers coprime to <span class="math inline">\(m\)</span> between <span class="math inline">\(1\)</span> and <span class="math inline">\(p_3\)</span> (or all numbers coprime to <span class="math inline">\(m\)</span> if <span class="math inline">\(m\)</span> has fewer than <span class="math inline">\(3\)</span> prime factors).</p>
<p><em>Proof.</em> <span class="math inline">\(S_m\)</span> clearly contains <span class="math inline">\(1,2,\ldots,p_1-1\)</span>. We now prove by induction over <span class="math inline">\(k\)</span> that <span class="math inline">\(S_m\)</span> contains all numbers coprime to <span class="math inline">\(m\)</span> which are smaller than <span class="math inline">\(\min(kp_1,p_3)\)</span>, starting with <span class="math inline">\(k=1\)</span>. Assume this statement for <span class="math inline">\(k=1\)</span>. Among the numbers <span class="math inline">\(kp_1+1,\ldots,kp_1+p_1-1\)</span>, at most one is divisible by <span class="math inline">\(p_2\)</span>, and all others are coprime to <span class="math inline">\(m\)</span>. There are three cases:</p>
<ul>
<li><span class="math inline">\(kp_1+1\)</span> and <span class="math inline">\(kp_1-1\)</span> are not divisible by <span class="math inline">\(p_2\)</span>. Then we may reach <span class="math inline">\(kp_1+1 = (kp_1-1)+2\)</span> and from there all of the numbers from <span class="math inline">\(kp_1+1\)</span> to <span class="math inline">\(kp_1+p_1-1\)</span> using steps of <span class="math inline">\(1\)</span> or <span class="math inline">\(2\)</span>.</li>
<li><span class="math inline">\(kp_1+1\)</span> is not divisible by <span class="math inline">\(p_2\)</span>, but <span class="math inline">\(kp_1-1\)</span> is. In that case, if <span class="math inline">\(p_1&gt;3\)</span>, we may reach <span class="math inline">\(kp_1+1 = (kp_1-2)+3\)</span> using a step of <span class="math inline">\(3\)</span> and all numbers to <span class="math inline">\(kp_1+p_1-1\)</span> using steps of size <span class="math inline">\(1\)</span>. If <span class="math inline">\(p_1=3\)</span>, <span class="math inline">\(p_2&gt;5\)</span>, and we can use <span class="math inline">\(kp_1+1 = (kp_1-4)+5\)</span> instead.</li>
<li><span class="math inline">\(kp_1+1\)</span> is divisible by <span class="math inline">\(p_2\)</span>. In that case, we may reach <span class="math inline">\(kp_1+2\)</span> using <span class="math inline">\((kp_1-2)+4\)</span>, and all numbers until <span class="math inline">\(kp_1+p_1-1\)</span> using steps of <span class="math inline">\(1\)</span>.</li>
</ul>
<p>This shows in particular that a potential counterexample must have at least <span class="math inline">\(3\)</span> prime factors. Similar “additive” arguments may be used to reach further, depending on bounds from below on the smallest prime factors. They do not alone seem sufficient to prove the theorem though, since in principle many prime factors can collude to produce long stretches of numbers not coprime to <span class="math inline">\(m\)</span>, and we will require “multiplicative” arguments in addition. These are based on the following observation:</p>
<p><strong>Lemma 2.</strong> <span class="math inline">\(S_m\)</span> is a multiplicative subgroup of <span class="math inline">\((\bZ/m)^\times\)</span>.</p>
<p><em>Proof.</em> Take <span class="math inline">\(r\in S_m\)</span>. The set of all <span class="math inline">\(x\in S_m\)</span> with <span class="math inline">\(rx\in S_m\)</span> contains <span class="math inline">\(1\)</span>, and whenever <span class="math inline">\(x,y\)</span> lie in that set and <span class="math inline">\(x+y\in (\bZ/m)^\times\)</span>, also <span class="math inline">\(x+y\)</span> lies in that set. So it contains <span class="math inline">\(S_m\)</span> and <span class="math inline">\(rS_m\subseteq S_m\)</span>. So <span class="math inline">\(S_m\)</span> is closed under multiplication, and since every element of <span class="math inline">\((\bZ/m)^\times\)</span> has finite order, it is a subgroup.</p>
<p>This allows us not only to multiply, but also to divide in <span class="math inline">\(S_m\)</span>. We use this to deduce a decomposition property for <span class="math inline">\(S_m\)</span>. Recall that if <span class="math inline">\(m=ab\)</span> with coprime <span class="math inline">\(a,b\)</span>, then <span class="math inline">\((\bZ/m)^\times = (\bZ/a)^\times \times (\bZ/b)^\times\)</span>. Since the projections take <span class="math inline">\(S_m\)</span> to <span class="math inline">\(S_a\)</span> and <span class="math inline">\(S_b\)</span>, <span class="math inline">\(S_m\)</span> is a subgroup of <span class="math inline">\(S_a\times S_b\)</span>. We have the following:</p>
<p><strong>Lemma 3.</strong> For coprime odd <span class="math inline">\(a,b\)</span>, if <span class="math inline">\(S_{ab}\subseteq (\bZ/a)^\times \times (\bZ/b)^\times\)</span> contains <span class="math inline">\((1,2)\)</span> (or <span class="math inline">\((2,1)\)</span>), then <span class="math inline">\(S_{ab}=S_a\times S_b\)</span>.</p>
<p><em>Proof.</em> Note first that if <span class="math inline">\(S_{ab}\)</span> contains <span class="math inline">\((2,1)\)</span>, it also contains <span class="math inline">\((1,2)\)</span>, since it contains <span class="math inline">\((2,2)=2=1+1\)</span>, and we may divide since it is a subgroup. Consider the set <span class="math inline">\(S\)</span> of all <span class="math inline">\(x\in S_a\)</span> such that <span class="math inline">\((x,1)\in S_{ab}\)</span>. If we have <span class="math inline">\(x,y\in S\)</span> such that <span class="math inline">\(x+y\in (\bZ/a)^\times\)</span>, <span class="math inline">\((x+y,2)\in S_{ab}\)</span>. Dividing by <span class="math inline">\((1,2)\)</span>, we learn that <span class="math inline">\((x+y,1)\in S_{ab}\)</span>, so <span class="math inline">\(x+y\in S\)</span>. Since <span class="math inline">\(1\in S\)</span> also, we have that <span class="math inline">\(S_a\subseteq S\)</span>, hence <span class="math inline">\(S_a\times \{1\}\subseteq S_{ab}\)</span>. Analogously, <span class="math inline">\(\{1\}\times S_b\subseteq S_{ab}\)</span>, so <span class="math inline">\(S_{ab}=S_a\times S_b\)</span>.</p>
<p>If we had a counterexample <span class="math inline">\(m\)</span> that admits such a decomposition <span class="math inline">\(m=ab\)</span> and <span class="math inline">\((1,2)\in S_{ab}\)</span>, then <span class="math inline">\(S_m = S_a\times S_b\)</span> would mean that one of <span class="math inline">\(a,b\)</span> also is a counterexample, giving a smaller one. If we find such a decomposition for any hypothetical <em>minimal</em> counterexample, this gives a contradiction. There is a helpful perspective here coming from algebraic geometry: For <span class="math inline">\(m= \prod p_i^{e_i}\)</span>, the decomposition <span class="math inline">\((\bZ/m)^\times = \prod (\bZ/p_i^{e_i})^\times\)</span> allows us to view elements of <span class="math inline">\((\bZ/m)^\times\)</span> as “functions” on a “space” <span class="math inline">\(\mathrm{Spec}(\bZ/m)\)</span> with one point for every prime divisor <span class="math inline">\(p_i\)</span> of <span class="math inline">\(m\)</span>, where the value at <span class="math inline">\(p_i\)</span> lands in <span class="math inline">\((\bZ/p_i^{e_i})^\times\)</span>. Our strategy can thus be summarized as trying to find elements of <span class="math inline">\((\bZ/m)^\times\)</span> which attain values <span class="math inline">\(1\)</span> and <span class="math inline">\(2\)</span> and are non-constant.</p>
<p>Elements of the form <span class="math inline">\((1,2)\)</span> are hard to produce. Fortunately, we can construct them from <span class="math inline">\(\pm 1\)</span>-valued elements. This is easiest in the case where <span class="math inline">\(3\)</span> does not divide <span class="math inline">\(m\)</span>:</p>
<p><strong>Lemma 4.</strong> If <span class="math inline">\(m=ab\)</span> with coprime odd <span class="math inline">\(a,b\)</span> not divisible by <span class="math inline">\(3\)</span>, and <span class="math inline">\((1,-1)\in S_{ab}\)</span>, <span class="math inline">\(S_{ab}=S_a\times S_b\)</span>.</p>
<p><em>Proof.</em> <span class="math inline">\(S_{ab}\)</span> contains <span class="math inline">\((3,3)\)</span>, hence <span class="math inline">\((4,2)\)</span>. Dividing by <span class="math inline">\(2\)</span>, it contains <span class="math inline">\((2,1)\)</span> and can be decomposed using Lemma 3.</p>
<p>If <span class="math inline">\(3\)</span> divides <span class="math inline">\(m\)</span>, we have a similar, but slightly more complicated statement.</p>
<p><strong>Lemma 5.</strong> If <span class="math inline">\(m=ab\)</span> with coprime odd <span class="math inline">\(a,b\)</span>, with <span class="math inline">\(a\)</span> divisible by <span class="math inline">\(3\)</span>, and both <span class="math inline">\(a,b\)</span> not divisible by <span class="math inline">\(5\)</span>, and <span class="math inline">\((1,-1)\in S_{ab}\)</span>, <span class="math inline">\(S_{ab} = S_a\times S_b\)</span>.</p>
<p><em>Proof.</em> <span class="math inline">\(S_{ab}\)</span> contains <span class="math inline">\((5,5)\)</span> and <span class="math inline">\((5,3) = (4,4)+(1,-1)\)</span>. It also contains <span class="math inline">\((5,-3)=(5,3)\cdot (1,-1)\)</span>, and thus <span class="math inline">\((10,2) = (5,5)+(5,-3)\)</span>. Furthermore, it contains <span class="math inline">\((10,6)=(5,3)+(5,3)\)</span>, and the quotient <span class="math inline">\((1,3) = (10,6)/(10,2)\)</span>. Now finally it contains <span class="math inline">\((2,4)=(1,3)+(1,1)\)</span>, and dividing by <span class="math inline">\(2\)</span>, it contains <span class="math inline">\((1,2)\)</span> and can be decomposed using Lemma 3.</p>
<p>Now we only need to construct such values which are <span class="math inline">\(\pm 1\)</span> everywhere:</p>
<p><strong>Lemma 6.</strong> If <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> are the two smallest primes dividing <span class="math inline">\(m\)</span>, <span class="math inline">\(S_m\)</span> contains an element which is <span class="math inline">\(\pm 1\)</span> everywhere, not constant, and <span class="math inline">\(+1\)</span> at <span class="math inline">\(p\)</span>.</p>
<p><em>Proof.</em> <span class="math inline">\((p_2+p_1)/2\)</span> and <span class="math inline">\((p_2-p_1)/2\)</span> are both coprime to <span class="math inline">\(m\)</span> and smaller than <span class="math inline">\(p_2\)</span>, hence contained in <span class="math inline">\(S_m\)</span> by Lemma 1. Their quotient <span class="math inline">\(q\)</span> is <span class="math inline">\(+1\)</span> mod <span class="math inline">\(p_1\)</span> and <span class="math inline">\(-1\)</span> mod <span class="math inline">\(p_2\)</span>. For a prime <span class="math inline">\(p_i\)</span> dividing <span class="math inline">\(m\)</span> with multiplicity <span class="math inline">\(e_i\)</span>, let us refer as “the order of <span class="math inline">\(q\)</span> at <span class="math inline">\(p_i\)</span>” to the order of <span class="math inline">\(q\)</span> in <span class="math inline">\((\bZ/p_i^{e_i})^\times\)</span>. We observe that the order of <span class="math inline">\(q\)</span> at <span class="math inline">\(p_1\)</span> is a power of <span class="math inline">\(p_1\)</span> (hence odd), and the order of <span class="math inline">\(q\)</span> at <span class="math inline">\(p_2\)</span> is <span class="math inline">\(2\)</span> times a power of <span class="math inline">\(p_2\)</span>. We may raise <span class="math inline">\(q\)</span> to the power of the product of the odd part of all those orders to obtain a <span class="math inline">\(q'\)</span> whose order is a power of <span class="math inline">\(2\)</span> everywhere, and <span class="math inline">\(1\)</span> at <span class="math inline">\(p_1\)</span> and <span class="math inline">\(2\)</span> at <span class="math inline">\(p_2\)</span>. Now either the order of <span class="math inline">\(q'\)</span> at all other <span class="math inline">\(p_i\)</span> is at most <span class="math inline">\(2\)</span>, in which case <span class="math inline">\(q'\)</span> is <span class="math inline">\(\pm 1\)</span> everywhere, <span class="math inline">\(-1\)</span> at <span class="math inline">\(p_2\)</span> and <span class="math inline">\(+1\)</span> at <span class="math inline">\(p_1\)</span>, or we may raise <span class="math inline">\(q'\)</span> to a <span class="math inline">\(2^k\)</span>-th power in order to obtain <span class="math inline">\(q''\)</span> whose order is at most <span class="math inline">\(2\)</span> everywhere and nonconstant, so that <span class="math inline">\(q''\)</span> is <span class="math inline">\(\pm 1\)</span> everywhere, <span class="math inline">\(+1\)</span> at <span class="math inline">\(p_1\)</span>, and <span class="math inline">\(-1\)</span> somewhere.</p>
<p>With this, we are now ready to prove the theorem.</p>
<p><em>Proof of the Theorem.</em> Assume <span class="math inline">\(m\)</span> is a minimal counterexample. By Lemma 1, <span class="math inline">\(m\)</span> has at least three prime factors. Let <span class="math inline">\(q\in S_m\)</span> be an element (guaranteed by Lemma 6) which is <span class="math inline">\(\pm 1\)</span> at all primes <span class="math inline">\(p_i\)</span> dividing <span class="math inline">\(m\)</span>, <span class="math inline">\(+1\)</span> at the smallest prime <span class="math inline">\(p_1\)</span>, and not constant. Let <span class="math inline">\(a\)</span> be the product of the prime powers modulo which <span class="math inline">\(q\)</span> is <span class="math inline">\(1\)</span>, and <span class="math inline">\(b\)</span> the product of the prime powers modulo which <span class="math inline">\(q\)</span> is <span class="math inline">\(-1\)</span>, so that <span class="math inline">\(q=(1,-1)\)</span> in <span class="math inline">\((\bZ/m)^\times = (\bZ/a)^\times \times (\bZ/b)^\times\)</span>. Now if <span class="math inline">\(p_1&gt;3\)</span>, Lemma 4 applies to show <span class="math inline">\(S_m = S_a\times S_b\)</span>. If <span class="math inline">\(p_1=3\)</span>, Lemma 5 applies to show <span class="math inline">\(S_m=S_a\times S_b\)</span>, since <span class="math inline">\(a\)</span> contains the smallest prime factor and is thus divisible by <span class="math inline">\(p_1=3\)</span>. In either case, one of <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> must also be a counterexample, contradicting minimality.</p>

        </div>
        <div id="footer">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
    </body>
</html>
